[2024-07-12T04:55:21.083+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: data_ingestion.ingest_task manual__2024-07-12T00:17:04.240558+00:00 [queued]>
[2024-07-12T04:55:21.087+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: data_ingestion.ingest_task manual__2024-07-12T00:17:04.240558+00:00 [queued]>
[2024-07-12T04:55:21.087+0000] {taskinstance.py:2193} INFO - Starting attempt 8 of 9
[2024-07-12T04:55:21.093+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonVirtualenvOperator): ingest_task> on 2024-07-12 00:17:04.240558+00:00
[2024-07-12T04:55:21.095+0000] {standard_task_runner.py:60} INFO - Started process 666 to run task
[2024-07-12T04:55:21.097+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'data_ingestion', 'ingest_task', 'manual__2024-07-12T00:17:04.240558+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion.py', '--cfg-path', '/tmp/tmpmwvgbwm0']
[2024-07-12T04:55:21.099+0000] {standard_task_runner.py:88} INFO - Job 18: Subtask ingest_task
[2024-07-12T04:55:21.109+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-07-12T04:55:21.127+0000] {task_command.py:423} INFO - Running <TaskInstance: data_ingestion.ingest_task manual__2024-07-12T00:17:04.240558+00:00 [running]> on host ***-scheduler
[2024-07-12T04:55:21.156+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='data_ingestion' AIRFLOW_CTX_TASK_ID='ingest_task' AIRFLOW_CTX_EXECUTION_DATE='2024-07-12T00:17:04.240558+00:00' AIRFLOW_CTX_TRY_NUMBER='8' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-07-12T00:17:04.240558+00:00'
[2024-07-12T04:55:21.485+0000] {datahub_listener.py:207} ERROR - Error sending metadata to datahub: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
    response.raise_for_status()
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
    self.emit_mcp(item)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
    self._emit_generic(url, payload)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
    raise OperationalError(
datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:55:21.486+0000] {logging_mixin.py:188} WARNING - Exception in thread Thread-1:
[2024-07-12T04:55:21.486+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:55:21.486+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
[2024-07-12T04:55:21.487+0000] {logging_mixin.py:188} WARNING -     response.raise_for_status()
[2024-07-12T04:55:21.487+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
[2024-07-12T04:55:21.487+0000] {logging_mixin.py:188} WARNING -     raise HTTPError(http_error_msg, response=self)
[2024-07-12T04:55:21.487+0000] {logging_mixin.py:188} WARNING - requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal
[2024-07-12T04:55:21.487+0000] {logging_mixin.py:188} WARNING - 
The above exception was the direct cause of the following exception:
[2024-07-12T04:55:21.488+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:55:21.488+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2024-07-12T04:55:21.488+0000] {logging_mixin.py:188} WARNING -     self.run()
[2024-07-12T04:55:21.488+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 870, in run
[2024-07-12T04:55:21.488+0000] {logging_mixin.py:188} WARNING -     self._target(*self._args, **self._kwargs)
[2024-07-12T04:55:21.489+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 407, in on_task_instance_running
[2024-07-12T04:55:21.489+0000] {logging_mixin.py:188} WARNING -     self.emitter.emit(mcp, self._make_emit_callback())
[2024-07-12T04:55:21.489+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
[2024-07-12T04:55:21.489+0000] {logging_mixin.py:188} WARNING -     self.emit_mcp(item)
[2024-07-12T04:55:21.489+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
[2024-07-12T04:55:21.490+0000] {logging_mixin.py:188} WARNING -     self._emit_generic(url, payload)
[2024-07-12T04:55:21.490+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
[2024-07-12T04:55:21.490+0000] {logging_mixin.py:188} WARNING -     raise OperationalError(
[2024-07-12T04:55:21.490+0000] {logging_mixin.py:188} WARNING - datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:55:21.491+0000] {process_utils.py:182} INFO - Executing cmd: /usr/local/bin/python -m virtualenv /tmp/venvk7bm1fkx --python=python
[2024-07-12T04:55:21.496+0000] {process_utils.py:186} INFO - Output:
[2024-07-12T04:55:21.830+0000] {process_utils.py:190} INFO - created virtual environment CPython3.8.19.final.0-64 in 118ms
[2024-07-12T04:55:21.831+0000] {process_utils.py:190} INFO -   creator CPython3Posix(dest=/tmp/venvk7bm1fkx, clear=False, no_vcs_ignore=False, global=False)
[2024-07-12T04:55:21.832+0000] {process_utils.py:190} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/***/.local/share/virtualenv)
[2024-07-12T04:55:21.832+0000] {process_utils.py:190} INFO -     added seed packages: pip==24.0, setuptools==69.1.0, wheel==0.42.0
[2024-07-12T04:55:21.833+0000] {process_utils.py:190} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-07-12T04:55:21.852+0000] {process_utils.py:182} INFO - Executing cmd: /tmp/venvk7bm1fkx/bin/pip install -r /tmp/venvk7bm1fkx/requirements.txt
[2024-07-12T04:55:21.857+0000] {process_utils.py:186} INFO - Output:
[2024-07-12T04:55:22.348+0000] {process_utils.py:190} INFO - ERROR: Can not perform a '--user' install. User site-packages are not visible in this virtualenv.
[2024-07-12T04:55:22.436+0000] {process_utils.py:190} INFO - 
[2024-07-12T04:55:22.436+0000] {process_utils.py:190} INFO - [notice] A new release of pip is available: 24.0 -> 24.1.2
[2024-07-12T04:55:22.436+0000] {process_utils.py:190} INFO - [notice] To update, run: python -m pip install --upgrade pip
[2024-07-12T04:55:22.485+0000] {datahub_listener.py:207} ERROR - Error sending metadata to datahub: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
    response.raise_for_status()
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
    self.emit_mcp(item)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
    self._emit_generic(url, payload)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
    raise OperationalError(
datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:55:22.486+0000] {logging_mixin.py:188} WARNING - Exception in thread Thread-2:
[2024-07-12T04:55:22.486+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:55:22.486+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
[2024-07-12T04:55:22.486+0000] {logging_mixin.py:188} WARNING -     response.raise_for_status()
[2024-07-12T04:55:22.487+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
[2024-07-12T04:55:22.487+0000] {logging_mixin.py:188} WARNING -     raise HTTPError(http_error_msg, response=self)
[2024-07-12T04:55:22.487+0000] {logging_mixin.py:188} WARNING - requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal
[2024-07-12T04:55:22.487+0000] {logging_mixin.py:188} WARNING - 
The above exception was the direct cause of the following exception:
[2024-07-12T04:55:22.487+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:55:22.488+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2024-07-12T04:55:22.488+0000] {logging_mixin.py:188} WARNING -     self.run()
[2024-07-12T04:55:22.488+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 870, in run
[2024-07-12T04:55:22.488+0000] {logging_mixin.py:188} WARNING -     self._target(*self._args, **self._kwargs)
[2024-07-12T04:55:22.488+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 523, in on_task_instance_failed
[2024-07-12T04:55:22.489+0000] {logging_mixin.py:188} WARNING -     self.on_task_instance_finish(task_instance, status=InstanceRunResult.FAILURE)
[2024-07-12T04:55:22.489+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 476, in on_task_instance_finish
[2024-07-12T04:55:22.489+0000] {logging_mixin.py:188} WARNING -     self.emitter.emit(mcp, self._make_emit_callback())
[2024-07-12T04:55:22.489+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
[2024-07-12T04:55:22.490+0000] {logging_mixin.py:188} WARNING -     self.emit_mcp(item)
[2024-07-12T04:55:22.490+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
[2024-07-12T04:55:22.490+0000] {logging_mixin.py:188} WARNING -     self._emit_generic(url, payload)
[2024-07-12T04:55:22.490+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
[2024-07-12T04:55:22.491+0000] {logging_mixin.py:188} WARNING -     raise OperationalError(
[2024-07-12T04:55:22.491+0000] {logging_mixin.py:188} WARNING - datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:55:22.491+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 401, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 721, in execute_callable
    self._prepare_venv(tmp_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 633, in _prepare_venv
    prepare_virtualenv(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/python_virtualenv.py", line 118, in prepare_virtualenv
    execute_in_subprocess(pip_cmd)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/process_utils.py", line 171, in execute_in_subprocess
    execute_in_subprocess_with_kwargs(cmd, cwd=cwd)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/process_utils.py", line 194, in execute_in_subprocess_with_kwargs
    raise subprocess.CalledProcessError(exit_code, cmd)
subprocess.CalledProcessError: Command '['/tmp/venvk7bm1fkx/bin/pip', 'install', '-r', '/tmp/venvk7bm1fkx/requirements.txt']' returned non-zero exit status 1.
[2024-07-12T04:55:22.497+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=data_ingestion, task_id=ingest_task, execution_date=20240712T001704, start_date=20240712T045521, end_date=20240712T045522
[2024-07-12T04:55:22.505+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 18 for task ingest_task (Command '['/tmp/venvk7bm1fkx/bin/pip', 'install', '-r', '/tmp/venvk7bm1fkx/requirements.txt']' returned non-zero exit status 1.; 666)
[2024-07-12T04:55:22.548+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-12T04:55:22.560+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
