[2024-07-12T04:59:04.347+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: data_ingestion.ingest_from_mariadb manual__2024-07-12T04:55:12.603012+00:00 [queued]>
[2024-07-12T04:59:04.356+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: data_ingestion.ingest_from_mariadb manual__2024-07-12T04:55:12.603012+00:00 [queued]>
[2024-07-12T04:59:04.356+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-07-12T04:59:04.365+0000] {taskinstance.py:2217} INFO - Executing <Task(_PythonDecoratedOperator): ingest_from_mariadb> on 2024-07-12 04:55:12.603012+00:00
[2024-07-12T04:59:04.372+0000] {standard_task_runner.py:60} INFO - Started process 875 to run task
[2024-07-12T04:59:04.381+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'data_ingestion', 'ingest_from_mariadb', 'manual__2024-07-12T04:55:12.603012+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion.py', '--cfg-path', '/tmp/tmphvjq1e2h']
[2024-07-12T04:59:04.387+0000] {standard_task_runner.py:88} INFO - Job 19: Subtask ingest_from_mariadb
[2024-07-12T04:59:04.418+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-07-12T04:59:04.452+0000] {task_command.py:423} INFO - Running <TaskInstance: data_ingestion.ingest_from_mariadb manual__2024-07-12T04:55:12.603012+00:00 [running]> on host ***-scheduler
[2024-07-12T04:59:04.511+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='data_ingestion' AIRFLOW_CTX_TASK_ID='ingest_from_mariadb' AIRFLOW_CTX_EXECUTION_DATE='2024-07-12T04:55:12.603012+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-07-12T04:55:12.603012+00:00'
[2024-07-12T04:59:05.270+0000] {datahub_listener.py:207} ERROR - Error sending metadata to datahub: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
    response.raise_for_status()
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
    self.emit_mcp(item)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
    self._emit_generic(url, payload)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
    raise OperationalError(
datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:59:05.272+0000] {logging_mixin.py:188} WARNING - Exception in thread Thread-1:
[2024-07-12T04:59:05.273+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:59:05.273+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
[2024-07-12T04:59:05.273+0000] {logging_mixin.py:188} WARNING -     response.raise_for_status()
[2024-07-12T04:59:05.273+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
[2024-07-12T04:59:05.274+0000] {logging_mixin.py:188} WARNING -     raise HTTPError(http_error_msg, response=self)
[2024-07-12T04:59:05.274+0000] {logging_mixin.py:188} WARNING - requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal
[2024-07-12T04:59:05.274+0000] {logging_mixin.py:188} WARNING - 
The above exception was the direct cause of the following exception:
[2024-07-12T04:59:05.274+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:59:05.275+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2024-07-12T04:59:05.275+0000] {logging_mixin.py:188} WARNING -     self.run()
[2024-07-12T04:59:05.275+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 870, in run
[2024-07-12T04:59:05.276+0000] {logging_mixin.py:188} WARNING -     self._target(*self._args, **self._kwargs)
[2024-07-12T04:59:05.276+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 407, in on_task_instance_running
[2024-07-12T04:59:05.276+0000] {logging_mixin.py:188} WARNING -     self.emitter.emit(mcp, self._make_emit_callback())
[2024-07-12T04:59:05.276+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
[2024-07-12T04:59:05.277+0000] {logging_mixin.py:188} WARNING -     self.emit_mcp(item)
[2024-07-12T04:59:05.277+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
[2024-07-12T04:59:05.277+0000] {logging_mixin.py:188} WARNING -     self._emit_generic(url, payload)
[2024-07-12T04:59:05.277+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
[2024-07-12T04:59:05.278+0000] {logging_mixin.py:188} WARNING -     raise OperationalError(
[2024-07-12T04:59:05.278+0000] {logging_mixin.py:188} WARNING - datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:59:05.365+0000] {base.py:83} INFO - Using connection ID 'datahub_rest_default' for task execution.
[2024-07-12T04:59:05.383+0000] {pipeline.py:269} INFO - Sink configured successfully. DataHubRestEmitter: configured to talk to http://datahub-gms:8080 with token: eyJh**********rE10
[2024-07-12T04:59:05.425+0000] {datahub_listener.py:207} ERROR - Error sending metadata to datahub: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
    response.raise_for_status()
  File "/home/airflow/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
    self.emit_mcp(item)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
    self._emit_generic(url, payload)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
    raise OperationalError(
datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:59:05.427+0000] {logging_mixin.py:188} WARNING - Exception in thread Thread-2:
[2024-07-12T04:59:05.428+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:59:05.428+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 284, in _emit_generic
[2024-07-12T04:59:05.429+0000] {logging_mixin.py:188} WARNING -     response.raise_for_status()
[2024-07-12T04:59:05.429+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
[2024-07-12T04:59:05.430+0000] {logging_mixin.py:188} WARNING -     raise HTTPError(http_error_msg, response=self)
[2024-07-12T04:59:05.431+0000] {logging_mixin.py:188} WARNING - requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal
[2024-07-12T04:59:05.431+0000] {logging_mixin.py:188} WARNING - 
The above exception was the direct cause of the following exception:
[2024-07-12T04:59:05.432+0000] {logging_mixin.py:188} WARNING - Traceback (most recent call last):
[2024-07-12T04:59:05.432+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 932, in _bootstrap_inner
[2024-07-12T04:59:05.433+0000] {logging_mixin.py:188} WARNING -     self.run()
[2024-07-12T04:59:05.433+0000] {logging_mixin.py:188} WARNING -   File "/usr/local/lib/python3.8/threading.py", line 870, in run
[2024-07-12T04:59:05.434+0000] {logging_mixin.py:188} WARNING -     self._target(*self._args, **self._kwargs)
[2024-07-12T04:59:05.435+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 523, in on_task_instance_failed
[2024-07-12T04:59:05.436+0000] {logging_mixin.py:188} WARNING -     self.on_task_instance_finish(task_instance, status=InstanceRunResult.FAILURE)
[2024-07-12T04:59:05.436+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub_***_plugin/datahub_listener.py", line 476, in on_task_instance_finish
[2024-07-12T04:59:05.436+0000] {logging_mixin.py:188} WARNING -     self.emitter.emit(mcp, self._make_emit_callback())
[2024-07-12T04:59:05.437+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 212, in emit
[2024-07-12T04:59:05.437+0000] {logging_mixin.py:188} WARNING -     self.emit_mcp(item)
[2024-07-12T04:59:05.438+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 253, in emit_mcp
[2024-07-12T04:59:05.438+0000] {logging_mixin.py:188} WARNING -     self._emit_generic(url, payload)
[2024-07-12T04:59:05.439+0000] {logging_mixin.py:188} WARNING -   File "/home/***/.local/lib/python3.8/site-packages/datahub/emitter/rest_emitter.py", line 298, in _emit_generic
[2024-07-12T04:59:05.440+0000] {logging_mixin.py:188} WARNING -     raise OperationalError(
[2024-07-12T04:59:05.440+0000] {logging_mixin.py:188} WARNING - datahub.configuration.common.OperationalError: ('Unable to emit metadata to DataHub GMS', {'message': '401 Client Error: Unauthorized for url: http://datahub-gms:8080/aspects?action=ingestProposal'})
[2024-07-12T04:59:05.441+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/api/registry.py", line 126, in _ensure_not_lazy
    plugin_class = import_path(path)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/api/registry.py", line 56, in import_path
    item = importlib.import_module(module_name)
  File "/usr/local/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/source/sql/mariadb.py", line 9, in <module>
    from datahub.ingestion.source.sql.mysql import MySQLConfig, MySQLSource
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/source/sql/mysql.py", line 3, in <module>
    import pymysql  # noqa: F401
ModuleNotFoundError: No module named 'pymysql'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/run/pipeline.py", line 136, in _add_init_error_context
    yield
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/run/pipeline.py", line 284, in __init__
    source_class = source_registry.get(self.source_type)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/api/registry.py", line 176, in get
    raise ConfigurationError(
datahub.configuration.common.ConfigurationError: mariadb is disabled; try running: pip install 'acryl-datahub[mariadb]'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/decorators/base.py", line 241, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/data_ingestion.py", line 87, in ingest_from_mariadb
    pipeline = Pipeline.create(
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/run/pipeline.py", line 408, in create
    return cls(
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/run/pipeline.py", line 284, in __init__
    source_class = source_registry.get(self.source_type)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/airflow/.local/lib/python3.8/site-packages/datahub/ingestion/run/pipeline.py", line 140, in _add_init_error_context
    raise PipelineInitError(f"Failed to {step}: {e}") from e
datahub.ingestion.run.pipeline.PipelineInitError: Failed to find a registered source for type mariadb: mariadb is disabled; try running: pip install 'acryl-datahub[mariadb]'
[2024-07-12T04:59:05.452+0000] {taskinstance.py:1149} INFO - Marking task as UP_FOR_RETRY. dag_id=data_ingestion, task_id=ingest_from_mariadb, execution_date=20240712T045512, start_date=20240712T045904, end_date=20240712T045905
[2024-07-12T04:59:05.467+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 19 for task ingest_from_mariadb (Failed to find a registered source for type mariadb: mariadb is disabled; try running: pip install 'acryl-datahub[mariadb]'; 875)
[2024-07-12T04:59:05.549+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-07-12T04:59:05.594+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
